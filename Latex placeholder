
\subsection*{Step 3.2 Geometric Feature Analysis for 3D Mesh Characterisation}

This section discusses the use of geometric features to describe three-dimensional mesh models. These features are important for comparing shapes to one another based on their characteristics.

\subsubsection*{3D elementary descriptors}

Elementary descriptors give a broad, global description of a 3D object's size, spatial extent, and shape complexity. To calculate these descriptors accurately, each model must be watertight, which means that all the holes created by sets of boundary edges need to be filled in. We used a trimesh function to achieve this. After the holes have been filled, the shapes' faces and windings are corrected to ensure consistent structure. After all this processing, the descriptors can be calculated.
For a mesh that has a volume $V$, a surface area $A$, and a set of vertices $\{x_i\}$, the main features are defined below:

\subsubsection*{Size and Extent}

\begin{itemize}
    \item \textbf{Volume ($V$)}: This measures the space enclosed by the mesh's boundary. It is calculated by summing the signed volumes of tetrahedra formed by each face and a reference point. This is done using the following formula:
    \[
    V = \frac{1}{6} \sum (v_1 \times v_2) \cdot v_3
    \]

    \item \textbf{Surface Area ($A$)}: This represents the total outer area of the mesh, calculated by adding the areas of all triangular faces:
    \[
    A = \sum_{\text{faces}} \left(0.5 \cdot \| (v_2 - v_1) \times (v_3 - v_1) \| \right)
    \]
    Here, $v_1, v_2, v_3$ are the vertices of a triangular face.

    \item \textbf{Diameter ($D$)}: An estimate of the mesh's maximum size, determined using the side lengths $(l_1, l_2, l_3)$ of the Bounding Box, calculated as follows:
    \[
    D \approx \sqrt{l_1^2 + l_2^2 + l_3^2}
    \]

    \item \textbf{Convexity ($C$)}: This measures how much the shape indents. It is given by the ratio of the object's volume $V$ to the volume of its convex hull $V_{\text{hull}}$:
    \[
    C = \frac{V}{V_{\text{hull}}}
    \]
    (Note: The original text stated $C = \frac{V_{\text{hull}}}{V}$ but the description "value ranges from (0,1], where a value close to 1 means few or no indentations" and standard geometric definitions imply the ratio should be $V/V_{\text{hull}}$ for a range of $(0, 1]$).
    The value ranges from $(0,1]$, where a value close to 1 means few or no indentations.

    \item \textbf{Compactness ($K$)}: A measure, with a perfect sphere achieving the highest score. Lower values of $K$ indicate elongated or more rectangular shapes. It is calculated using:
    \[
    K = \frac{6\sqrt{\pi}V}{A^{1.5}}
    \]

    \item \textbf{Rectangularity ($R$)}: This assesses how well the object fits within its oriented bounding box by dividing the volume of the object by the volume of the bounding box:
    \[
    R = \frac{V}{V_{\text{OBB}}}
    \]
    where \( V_{\text{OBB}} \) is the volume of the OBB, calculated as \( l_1 l_2 l_3 \).

    \item \textbf{Eccentricity ($E$)}: A metric that comes from the main inertia components (which are the eigenvalues of the inertia tensor), denoted as $I_1, I_2$, and $I_3$, where $I_1$ is the smallest and $I_3$ is the largest. This metric helps to measure how mass is spread out in an object and is expressed as:
    \[
    E = \frac{I_3}{I_1}
    \]
    When $E$ is close to 1, it means the mass distribution is pretty even and the shape is nearly spherical. If $E$ is much smaller than 1, it indicates that the object has a stretched or flattened shape. This metric provides a clear understanding of how the mass is organised within the object and what its overall shape resembles.
\end{itemize}

\subsection*{Shape Descriptors}

Shape descriptors provide a different way to analyse 3D meshes. They characterise a mesh by analysing geometric elements. This approach involves randomly sampling vertices from the mesh to create a distribution of various features. By gathering a considerable number of samples, we can form stable histograms that represent the geometric properties of the shape.

\subsubsection*{Descriptors and Formulas}

Five different geometric features are sampled to create a shape profile for an object, each highlighting a different aspect of the object's structure:

\begin{itemize}
    \item \textbf{Angles between three random vertices (A3)}:
        This descriptor captures the angular structure of the shape, providing information about typical geometric configurations independent of scale, rotation, or translation. To compute it, three vertices \( (x_1, x_2, x_3) \) are randomly sampled, and the angle \( \theta \) at vertex \( x_2 \) is determined from the vectors \( (x_1 - x_2) \) and \( (x_3 - x_2) \):
        \[
        \theta = \arccos \left( \frac{ (x_1 - x_2) \cdot (x_3 - x_2) }{ \|x_1 - x_2\| \, \|x_3 - x_2\| + \epsilon } \right).
        \]
        Here, \( \epsilon \) is a small numerical safeguard to avoid division by zero. Repeating this process for many vertex triples produces a distribution of angles—known as the \textit{A3 shape distribution}—that characterises the object’s geometry. Different shapes exhibit distinct angular distributions, making this descriptor useful for discriminating between them.

    \item \textbf{Distance between barycenter and random vertex ($D_1$)}: This descriptor measures how mass is distributed around the shape. It samples one vertex $x$ and calculates its distance $r$ to the shape's barycenter $\mu$:
    \[
    r = \| x - \mu \|
    \]

    \item \textbf{Distance between 2 random vertices ($D_2$)}: This looks at the distribution of distances inside the shape, offering insights into its proportions. This is done by randomly selecting two vertices $(x_i, x_j)$ and measuring the Euclidean distance $d$ between them:
    \[
    d = \| x_i - x_j \|
    \]

    \item  \textbf{Square root of the area of a triangle formed by three random vertices (D3)}:
            This descriptor captures the scale and planar dispersion of local surface patches. Three vertices \( (x_1, x_2, x_3) \) are randomly sampled to form a triangle. Its area \( A_{\triangle} \) can be computed using Heron’s formula, where \( a, b, c \) are the edge lengths and \( s \) is the semi-perimeter:
            \[
            a = \|x_2 - x_1\|, \quad b = \|x_3 - x_2\|, \quad c = \|x_1 - x_3\|
            \]
            \[
            s = \tfrac{1}{2}(a+b+c)
            \]
            \[
            A_{\triangle} = \sqrt{s(s-a)(s-b)(s-c)}.
            \]
            The stored descriptor value is the square root of the triangle area:
            \[
            \text{D3} = \sqrt{A_{\triangle}}.
            \]
            Taking the square root reduces the dynamic range of the descriptor, producing more stable histograms when aggregated across samples.


    \item \textbf{Cube root of volume of tetrahedron formed by four random vertices ($D_4$)}:
    To analyse the local structure within 3D space, we select four points $x_1, x_2, x_3, x_4$ and compute the volume $V_t$ of the tetrahedron they form together. The descriptor value $z_V$ is calculated by taking the cube root of this volume ($V_t^{1/3}$), addressing the impact of size on the features we are examining.

    The volume is expressed as:
    $$
    V_t = \frac{1}{6} \left|((x_2 - x_1) \cdot ((x_3 - x_1) \times (x_4 - x_1)))\right|
    $$

    Afterwards, we calculate:
    $$
    z_V = (V_t)^{1/3}
    $$
\end{itemize}
